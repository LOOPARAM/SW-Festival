(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7714:(e,t,a)=>{Promise.resolve().then(a.bind(a,8232))},8232:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var l=a(5155),r=a(2115),s=a(7058),c=a(9904),n=a(399);let o=(0,c.Wp)({apiKey:"AIzaSyBVXz7jht-PgIjWvb_d9QWNxiRPI79xtWQ",authDomain:"sw-festival-bc442.firebaseapp.com",projectId:"sw-festival-bc442",storageBucket:"sw-festival-bc442.firebasestorage.app",messagingSenderId:"166416416497",appId:"1:166416416497:web:499fe65109cb71a6b97350",measurementId:"G-JK1K1C925L"}),i=(0,s.aU)(o),d=(0,n.xI)(o),u=new n.LD("microsoft.com");async function m(e){try{u.setCustomParameters({prompt:"select_account"});let t=(await (0,n.df)(d,u)).user;e&&e(t)}catch(e){console.error("로그인 오류:",e.message)}}async function x(){try{await (0,n.CI)(d)}catch(e){console.error("로그아웃 오류:",e.message)}}async function h(e,t,a,l,r){if(!r)throw Error("로그인이 필요합니다.");let c=r.email.split("@")[0],n=(0,s.rJ)(i,e,t,String(a)),o=(0,s.H9)(n),d={id:c,score:l,grade:a-parseInt(r.email.split("@")[0].split("-")[0])-1999};return await (0,s.BN)(o,d),d}async function p(e,t,a,l,r){if(!r)throw Error("로그인이 필요합니다.");let c=r.email.split("@")[0],n=(0,s.rJ)(i,e,t,String(a)),o=await (0,s.GG)(n),d=null;return(o.forEach(e=>{e.data().id===c&&(d=e.ref)}),d)?(await (0,s.mZ)(d,{score:l}),console.log("학년-학기: ".concat(e,", 과목: ").concat(t,", 연도: ").concat(a,", ID: ").concat(c,", 점수 업데이트 성공: ").concat(l)),{id:c,subject:t,score:l}):(console.log("ID(".concat(c,")에 해당하는 문서를 찾을 수 없습니다. 새 문서를 추가합니다.")),await h(e,t,a,l,r))}async function f(e,t,a,l){if(!l)throw Error("로그인이 필요합니다.");let r=l.email.split("@")[0],c=(0,s.rJ)(i,e,t,String(a)),n=await (0,s.GG)(c),o=null;if(n.forEach(e=>{e.data().id===r&&(o=e.ref)}),!o){console.log("ID(".concat(r,")에 해당하는 문서를 찾을 수 없습니다."));return}await (0,s.kd)(o),console.log("학년-학기: ".concat(e,", 과목: ").concat(t,", 연도: ").concat(a,", ID: ").concat(r,", 점수 삭제 성공"))}function g(){let[e,t]=(0,r.useState)(null),[a,c]=(0,r.useState)(new Date().getFullYear()),[o,u]=(0,r.useState)(1),[h,g]=(0,r.useState)(1),[b,y]=(0,r.useState)(1),[v,j]=(0,r.useState)([]),[w,N]=(0,r.useState)({}),[I]=(0,r.useState)([1,2,3,4,5,6,7,8,9]),[k,S]=(0,r.useState)(!1),C=async()=>{if(!1===k){if(e){var l;(null===(l=e.email)||void 0===l?void 0:l.split("@")[1])==="kyungheeboy.hs.kr"&&a-parseInt(e.email.split("@")[0].split("-")[0])-1999<=3&&a-parseInt(e.email.split("@")[0].split("-")[0])-1999>=1?(S(!0),await E(e)):alert("".concat(a,"년 ").concat(o,"학년 ").concat(h,"학기 ").concat(1===b?"중간":"기말","고사 성적 반영에 적합하지 못한 사용자입니다."))}else try{m(e=>{if(e){var l;t(e),(null===(l=e.email)||void 0===l?void 0:l.split("@")[1])==="kyungheeboy.hs.kr"&&a-parseInt(e.email.split("@")[0].split("-")[0])-1999<=3&&a-parseInt(e.email.split("@")[0].split("-")[0])-1999>=1?(S(!0),E(e)):alert("".concat(a,"년 ").concat(o,"학년 ").concat(h,"학기 ").concat(1===b?"중간":"기말","고사 성적 반영에 적합하지 못한 사용자입니다."))}})}catch(e){console.error("Login failed:",e)}}else S(!1)},E=async e=>{try{var t;let l="".concat(o,"-").concat(h,"-").concat(b),r=null==e?void 0:null===(t=e.email)||void 0===t?void 0:t.split("@")[0],c={};for(let e of v){let t=(0,s.rJ)(i,l,e.name,String(a));(await (0,s.GG)(t)).forEach(t=>{console.log(e.name,t.data().id,r),t.data().id===r&&(c[e.name]=t.data().score)})}N(c),console.log("사용자 성적 데이터:",c)}catch(e){console.error("사용자 성적 데이터를 가져오는 중 오류 발생:",e)}};return(0,r.useEffect)(()=>{var e;e=e=>{t(e)},(0,n.hg)(d,t=>{t?e(t):e(null)})},[]),(0,r.useEffect)(()=>{(async function(){try{let e="".concat(o,"-").concat(h,"-").concat(b),t=(0,s.rJ)(i,e),l=await (0,s.GG)(t),r=await Promise.all(l.docs.map(async t=>{let l=t.id,r=(0,s.rJ)(i,e,l,String(a)),c=await (0,s.GG)(r);if(!c.empty){let e=c.docs.map(e=>e.data().score),t=function(e){let t=[...e].sort((e,t)=>t-e),a=t.length,l={},r=0;return Object.entries({1:.04,2:.11,3:.23,4:.4,5:.6,6:.77,7:.89,8:.96,9:1}).forEach(e=>{let[s,c]=e,n=parseInt(s),o=Math.ceil(a*c)-1,i=r+1;l[n]={cutoff:t[o]||0,range:"".concat(i," ~ ").concat(o+1)},r=o}),l}(e);return{name:l,participant:c.docs.length,gradeCutoffs:t}}return null}));j(r.filter(e=>null!==e))}catch(e){e instanceof Error?console.error("과목 데이터를 가져오는 중 오류 발생:",e.message):console.error("과목 데이터를 가져오는 중 알 수 없는 오류 발생:",e)}})()},[o,h,a,b,k]),(0,l.jsxs)("div",{className:"relative w-full h-screen overflow-hidden flex flex-col justify-center",children:[(0,l.jsx)("h1",{className:"min-h-20 text-center md:min-h-32 lg:min-h-48 font-bold flex flex-col justify-center text-5xl md:text-6xl lg:text-8xl",children:"내신 등급컷 예측기"}),(0,l.jsxs)("div",{className:"w-full transition-transform duration-500 ".concat(k?"-translate-x-full":"translate-x-0"),children:[(0,l.jsx)("div",{className:"mb-4 flex flex-wrap items-center justify-center gap-4 text-white",children:[{id:"year",label:"연도 선택",value:a,options:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>new Date().getFullYear()-t),onChange:e=>c(e)},{id:"grade",label:"학년 선택",value:o,options:[1,2,3],onChange:e=>u(e)},{id:"semester",label:"학기 선택",value:h,options:[1,2],onChange:e=>g(e)},{id:"examType",label:"시험 선택",value:b,options:[{value:1,label:"중간고사"},{value:2,label:"기말고사"}],onChange:e=>y(e)}].map(e=>{let{id:t,label:a,value:r,options:s,onChange:c}=e;return(0,l.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,l.jsx)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-200",children:a}),(0,l.jsx)("select",{id:t,value:r,onChange:e=>c(parseInt(e.target.value)),className:"mt-1 block w-full py-2 px-3 border border-gray-600 bg-gray-800 text-white rounded-md shadow-sm  focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:Array.isArray(s)?s.map(e=>"object"==typeof e?(0,l.jsx)("option",{value:e.value,children:e.label},e.value):(0,l.jsx)("option",{value:e,children:e},e)):null})]},t)})}),(0,l.jsx)("div",{className:"mb-6 text-center",children:(0,l.jsx)("button",{onClick:C,className:"bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg px-4 py-2",children:"성적 수정"})}),(0,l.jsx)("div",{className:"relative w-full overflow-x-auto",children:(0,l.jsxs)("table",{className:"table-auto min-w-[1400px] max-w-[1400px] mx-auto border-collapse text-sm text-left rtl:text-right text-gray-300",children:[(0,l.jsx)("thead",{className:"text-xs text-gray-200 uppercase bg-gray-900",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3",children:"과목"}),(0,l.jsx)("th",{className:"px-2 py-3",children:"참여자 수"}),I.map(e=>(0,l.jsxs)("th",{className:"px-2 py-3",children:[e,"등급컷"]},e))]})}),(0,l.jsx)("tbody",{children:v.map(e=>{let{name:t,participant:a,gradeCutoffs:r}=e;return(0,l.jsxs)("tr",{className:"border-b bg-gray-800 hover:bg-gray-700 dark:border-gray-700",children:[(0,l.jsx)("th",{className:"px-6 py-4 font-medium text-gray-100 whitespace-nowrap",children:t}),(0,l.jsx)("td",{className:"px-2 py-4",children:a}),I.map(e=>{let t=r[e];return(0,l.jsxs)("td",{className:"px-2 py-4",children:[t.cutoff," (",t.range,")"]},e)})]},t)})})]})})]}),(0,l.jsx)("div",{className:"absolute top-0 right-0 w-full h-full transition-transform duration-500 ".concat(k?"translate-x-0":"translate-x-full"),children:(0,l.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,l.jsxs)("div",{className:"overflow-x-auto max-w-[1400px] mx-auto",children:[(0,l.jsx)("div",{className:"min-h-52"}),(0,l.jsxs)("table",{className:"table-auto border-collapse text-sm text-left text-gray-300",children:[(0,l.jsx)("thead",{className:"text-xs text-gray-200 uppercase bg-gray-700",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3",children:"과목"}),(0,l.jsx)("th",{className:"px-6 py-3",children:"새로운 데이터"})]})}),(0,l.jsx)("tbody",{children:v.map(e=>{let{name:t}=e;return(0,l.jsxs)("tr",{className:"border-b bg-gray-800 hover:bg-gray-700",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:t}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("input",{type:"number",className:"px-3 py-2 border rounded-lg bg-gray-700 text-white",placeholder:"점수 입력",value:w[t]||"",onChange:e=>N({...w,[t]:e.target.value})})})]},t)})})]}),(0,l.jsx)("div",{className:"mt-6 flex justify-center",children:(0,l.jsx)("button",{onClick:async()=>{try{for(let[t,l]of Object.entries(w))l&&("string"!=typeof l||""!==l.trim())?(await p("".concat(o,"-").concat(h,"-").concat(b),t,a,Number(l),e),console.log("성적 업데이트 성공: ".concat(t," - ").concat(l))):(await f("".concat(o,"-").concat(h,"-").concat(b),t,a,e),console.log("성적 삭제 성공: ".concat(t)));alert("성적이 성공적으로 반영되었습니다."),S(!1)}catch(e){console.error("성적 처리 오류:",e),alert("성적 저장 중 문제가 발생했습니다.")}},className:"bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg px-4 py-2",children:"저장 및 돌아가기"})})]})})}),e?(0,l.jsx)("button",{onClick:async()=>{try{await x(),t(null),S(!1),console.log("로그아웃 성공")}catch(e){console.error("로그아웃 오류:")}},className:"absolute bottom-2 right-2 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg text-xs px-3 py-1",children:"로그아웃"}):null]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[882,992,985,441,517,358],()=>t(7714)),_N_E=e.O()}]);